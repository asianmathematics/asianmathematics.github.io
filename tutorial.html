<doctype html>
<html>
<head>
    <title>Squad combat tutorial</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="combat.css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
</head>
<body>
    <h1>Welcome to the Squad Combat Tutorial</h1>
    <p>This tutorial will guide you through the basics of the mechanics for my squad combat prototype. This prototype is based of the manual squad mode for my game where you manually take control of units actions.<p><br><br>
    <p>These are modifiers. For the current prototype, they just modify stats for a set duration, but in the future some modifiers can perform advanced abilities such as counterattacks or action/modifier nullification.</p>
    <div id="battle-container">
    </div>
    <p>These are units.</p>
    <ul>
        <li>All units have a name, HP, Stamina, and a timer. Some units can also have backline position, Mana, and Energy.</li>
        <li>A backline unit can't be targeted most attacks and effects from the opposing team. The goal for each team is to defeat all frontline units (any non-backline unit) of the opposing team. There are some midline units able to move between the front and backlines.</li>
        <li>A unit's HP represents how much damage it can take before being defeated. A unit can be healed after going down to 0 HP, but its hard to keep them alive afterwards</li>
        <li>Stamina, Mana, and Energy are resources a unit can use to make certain actions. Resources will be fully explained later.</li>
        <li>A unit's timer indicates when it can take its next action. Some units have different timer speed depending on its speed stat, having more turn frequency than others.</li>
    </ul>
    <div class="game-layout">
        <div class="left-column">
            <div id="action-log-container">
                <h3>Combat Log</h3>
                <div id="action-log" style="max-height: 250px;"></div>
            </div>
        </div>
        <div class="right-column">
            <div id="selection">
            </div>
            <p>These are actions, hovering over one of them (or holding it on mobile) will show more information about the action. Some actions require targeting a unit. After performing an action, it will be logged for reference to see the history of the battle.</p>
        </div>
    </div>
    <p>Note: When tag is referenced, that just means the action, unit, or modifier has the tag in it's name or description.</p>
    <h2>Advanced Mechanics</h2>
    <p>These mechanics aren't as clear in normal gameplay, so here's the run down.</p>
    <h3>Attributes and Resources</h3>
    <p>There are 3 different attributes (Physical, Mystic, and Techno) and a resource associated with each attribute (Stamina, Mana, and Energy).</p>
    <ul>
        <li>Actions tagged with a resource requires a certain amount of the resource to use the action. After using the action, that amount of the resource is used up. Actions tagged with a attribute has a cost of 0 of that resource.</li>
        <li>A unit regains all its resources at the start of its turn, unless it used an action tagged with the corresponding attribute or resource.</li>
        <li>All units have stamina, but not all units have mana or energy. Having more attributes generally makes a unit more powerful, but it becomes more vulnerable certain actions and effects targeting those attributes. </li>
    </ul>
    <h3>Stats</h3>
    <p>These are the stats that affect a unit's performance in combat. The exact calculations used for these stats will be displayed at the bottom of the page.</p>
    <ul>
        <li><strong>HP</strong><span>: Unit's health.</span></li>
        <li><strong>Attack</strong><span>: Amount of damage dealt to enemy from an attack.</span></li>
        <li><strong>Defense</strong><span>: Amount of damage reduced from attacks. Can reduce up to 1/10th of opponent's attack.</span></li>
        <li><strong>Lethality</strong><span>: Bonus damage from criticals.</span></li>
        <li><strong>Accuracy</strong><span>: Increase chance to hit an attack. Minimum chance to hit of 15%.</span></li>
        <li><strong>Evasion</strong><span>: Decrease chance to get attacked.</span></li>
        <li><strong>Crit</strong><span>: Increase critical and debuff chance. Multiple criticals can stack.</span></li>
        <li><strong>Resist</strong><span>: Decrease critical and debuff chance.</span></li>
        <li><strong>Speed</strong><span>: Increases turn frequency.</span></li>
        <li><strong>Presence</strong><span>: Increases chance to get targeted, and adds onto crit and resist for debuff calculations.</span></li>
    </ul>
    <h2>Future mechanics</h2>
    <p>These aren't implemented yet, but will be once I finish programming them.</p>
    <h3>Passive Skills</h3>
    <p>Units can have active skills (actions) and passive skills. A passive skill is a </p>
    <h3>Unit synergy</h3>
    <p>Certain unit may have synergies when paired with other units. These synergies may range from stat modifications to new actions to completely changing the unit. Due to the small amount of units and the limitations of the current build, this isn't implemented yet.</p>
    <h3>Element system</h3>
    <p>Units and actions are usually tagged with one or more elemental pairs. There are 9 main elemental pairs and 4 special elemental pairs. Units without an element are rare.</p>
    <ul>
        <li>Main Elements: Death/Darkness, Light/Illusion, Knowledge/Memory, Goner/Entropy, Harmonic/Change, Inertia/Cold, Radiance/Purity, Anomaly/Synthetic, and Nature/Life.</li>
        <li>Each element has pair associated, such as Death & Darkness, Light & Illusion, etc. And each main element has an opposite, such as Life & Death, Darkness & Light, etc. (This relation is shown by the order of each element in the list)</li>
        <li>To exploit an elemental weakness or resistance, a unit with an elemental pair must be hit by attacks tagged with the elemental pair's opposites (e.g. Death/Darkness unit hit with Nature/Life and Light/Illusion attacks). Healing and Buffs from an opposing pair of the unit weakens the effect while using the same pair as the unit increases effectiveness. Buffs and Debuffs can be weakened using attacks or Buff/Debuff incompatibility.</li>
        <li>Special Elements: Precision/Perfection, Independence/Loneliness, Passion/Hatred, and Ingenuity/Insanity.</li>
        <li>Special Elements don't have opposites, so they don't have the usual interactions as the main elements. These elements are mostly used for synergies.</li>
    </ul>
    <h3>Unit Progression</h3>
    <p>You can upgrade a unit by increasing it's level and power.</p>
    <ul>
        <li>Level increases the effectiveness of the unit's skills and unlocks more skills, while Power increases the unit's base stats. Certain effects and skills can affect Level and Power. The range of Level and Power is from -127 to 128 and can't go higher or lower.</li>
        <li>A unit gains Level xp from finishing a battle with the unit, while a unit gains Power xp from duplicates of the same unit or sacrifices. At higher star rarity, units will require a certain lower star quality unit to have its Power at least their Power level to increase it.</li>
        <li>You can sacrifice a duplicate to increase the Power of a the same unit or a compatable higher star unit to drastically increase a units Power. When certain units reaches max Level, you can prestige them to reset its level and massively boost a higher star unit's level and power. The prestiged unit keeps all its unlocked actions.</li>
    </ul>
    <h2>Formulas</h2>
Roll is a random number from 1-100<br><br>
To hit (accuracy doubles at a roll of 100 and auto miss at a 1, Hit ≤ 0 is a miss):<br>
\[Hit = \frac{Accuracy_{Attacker}}{Evasion_{Defender}} + Roll - 85\]<br><br>
To crit (denominator can't go below 10):<br>
\[Critical = \frac{Hit}{5Resist_{Defender}-Crit_{Attacker}}\]<br><br>
Damage function (HP can't go below 0):<br>
<p style="text-align: center;">If Critical < 1:</p> \[Damage_{Normal} = Attack_{Attacker} - Defense_{Defender}\] <p style="text-align: center">(Multiplied by a random number between .75 to 1.25, Minimum of 10% of attack or 1)</p><br><br>
<p style="text-align: center;">If Critical ≥ 1:</p> \[Damage_{Critical} = Damage_{Normal} \text{ (Minimum increased by * Critical)} + Lethality_{Attacker} * Critical\]<br><br>
Debuff (debuff is applied if number is positive, auto apply on 100 and auto fail on 1, denominator can't go below 20):<br>
\[Debuff = \frac{Presence_{Attacker} + Crit_{Attacker}}{200-(Presence_{Attacker} + Crit_{Attacker}) + (Presence_{Defender} + Resist_{Defender})} + Roll - DebuffSpecificConstant\]
</body>
<script type="module">
    import { Electric } from './unit/electric.js';
    import { Unit } from './unit/unit.js';
    import { createUnit, advanceWave, combatTick } from './combat.js';
    document.addEventListener('DOMContentLoaded', function() {
        createUnit(Electric, 'player');
        createUnit(new Unit('Basic Dummy', [500, 40, 10, 25, 100, 20, 100, 35, 0, 100, "front", 100, 10], () => {}), 'enemy');
        createUnit(new Unit('Mystic Dummy', [425, 35, 8, 35, 110, 30, 115, 25, 0, 100, "front", 80, 8, 180, 20], () => {}), 'enemy');
        createUnit(new Unit('Techno-backline Dummy', [475, 40, 12, 20, 105, 20, 90, 40, 0, 110, "back", 60, 6, undefined, undefined, 150, 15], () => []), 'enemy');
        advanceWave(-1);
        combatTick();
    });
</script>
</html>